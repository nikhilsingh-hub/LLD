package LogCompression;

import io.micrometer.common.util.StringUtils;
import org.apache.kafka.clients.consumer.ConsumerRecord;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.util.*;
import java.util.zip.*;

public class compressionTecniques {

    public static void main(String[] args) {
        String curr = "{\"eventCode\":\"12128019\",\"settleType\":\"DIRECT_SETTLEMENT\",\"pdEventCode\":\"12128018\",\"pushedTime\":\"2025-09-01T00:40:15.177+05:30\",\"merchantId\":\"HPCL3078443994364653\",\"clientId\":\"2016030715243903536806\",\"resultCode\":\"T\",\"acquirementId\":\"20250827010980000167261398070727566\",\"acquireMode\":\"PAY_CONFIRM\",\"contractId\":\"306212875891755009\",\"merchantTransId\":\"2025082700400302079526628476\",\"orderAmount\":{\"cent\":100063,\"currency\":\"INR\",\"currencyValue\":\"356\",\"currencyCode\":\"INR\",\"centFactor\":100,\"amount\":1000.63},\"orderCreatedTime\":\"2025-09-01T00:40:03.952+05:30\",\"orderStatus\":\"SUCCESS\",\"buyerId\":\"216810000000000024242\",\"extendInfo\":{\"ADDITIONAL_META_INFO\":\"{\\\"settleStrategy\\\":\\\"REALTIME\\\",\\\"productMode\\\":\\\"AUTH_CAPTURE\\\",\\\"instantSettlement\\\":\\\"false\\\",\\\"confirmTimeoutAction\\\":\\\"CONFIRM\\\",\\\"mpa\\\":\\\"501033007435648224\\\",\\\"isPayAttempted\\\":\\\"T\\\"}\",\"ORDER_CREATE_EXTEND_INFO\":\"{\\\"totalTxnAmount\\\":\\\"1000.63\\\",\\\"ROUTE\\\":\\\"PG2\\\",\\\"shiftNumber\\\":\\\"0002\\\",\\\"confirmTimeOut\\\":\\\"43200\\\",\\\"accuracy\\\":\\\"12.768\\\",\\\"source\\\":\\\"Searce\\\",\\\"PRODUCT_CODE\\\":\\\"51051000100000000147\\\",\\\"merchantName\\\":\\\"AUTO LINES\\\",\\\"mode\\\":\\\"UPI_QR_CODE\\\",\\\"merchantSubCategory\\\":\\\"HPCL Pump\\\",\\\"terminalLongitude\\\":\\\"73.863224\\\",\\\"posYear\\\":\\\"2025\\\",\\\"linkBasedInvoicePayment\\\":\\\"false\\\",\\\"TXN_AMOUNT\\\":\\\"1000.63\\\",\\\"topupAndPay\\\":\\\"false\\\",\\\"merchantReferenceNo\\\":\\\"null\\\",\\\"terminalLatitude\\\":\\\"18.523929\\\",\\\"REQUEST_TYPE\\\":\\\"DYNAMIC_QR\\\",\\\"edcRequest\\\":\\\"true\\\",\\\"isPostFactoTxn\\\":\\\"false\\\",\\\"transactionDateTime\\\":\\\"null\\\",\\\"isEdcRequest\\\":\\\"true\\\",\\\"isHDFCDigiPOSMerchant\\\":\\\"false\\\",\\\"merchantTransId\\\":\\\"2025082700400302079526628476\\\",\\\"paytmMerchantId\\\":\\\"HPCL3078443994364653\\\",\\\"posDate\\\":\\\"0827\\\",\\\"merchantCategory\\\":\\\"Gas and Petrol\\\",\\\"orderAlreadyCreated\\\":\\\"true\\\",\\\"oldPGMerchantId\\\":\\\"216820000266977048752\\\",\\\"usrLBSLongitude\\\":\\\"73.843131\\\",\\\"clientConfirmWaitTime\\\":\\\"1756235404289\\\",\\\"usrLBSLatitude\\\":\\\"18.5317335\\\",\\\"ecrIntegrationSource\\\":\\\"nonEcr\\\",\\\"ecrMerchantCallBackUrl\\\":\\\"null\\\",\\\"posId\\\":\\\"26628476\\\",\\\"merchantUniqueReference\\\":\\\"true\\\",\\\"invoiceNumber\\\":\\\"020795\\\",\\\"terminalAddress\\\":\\\"AUTO LINES,AUTO LINES\\\",\\\"networkType\\\":\\\"Wifi\\\",\\\"merchantType\\\":\\\"null\\\",\\\"timestamp\\\":\\\"1756202047620\\\",\\\"posTime\\\":\\\"004003\\\",\\\"paytmTid\\\":\\\"26628476\\\",\\\"qrCodeId\\\":\\\"9548363118X1756235403908\\\",\\\"callBackURL\\\":\\\"https://securegw.paytm.in/theia/paytmCallback?ORDER_ID=2025082700400302079526628476\\\",\\\"clientId\\\":\\\"PAXA910S020124\\\",\\\"requestType\\\":\\\"DYNAMIC_QR\\\",\\\"deviceVersion\\\":\\\"3.023.004\\\",\\\"udf1\\\":\\\"26628476\\\",\\\"productCode\\\":\\\"51051000100000000147\\\",\\\"deviceSerialNo\\\":\\\"2841029140\\\",\\\"operatorType\\\":\\\"airtel\\\",\\\"simNo\\\":\\\"8991102305870228436\\\",\\\"extServiceId\\\":\\\"null\\\"}\",\"ENV_INFO\":\"{\\\"sessionId\\\":\\\"\\\",\\\"tokenId\\\":\\\"\\\",\\\"webSiteLanguage\\\":\\\"\\\",\\\"clientIp\\\":\\\"10.191.4.98\\\",\\\"terminalType\\\":\\\"WEB\\\",\\\"osType\\\":\\\"unknown\\\",\\\"orderTerminalType\\\":\\\"\\\",\\\"orderOSType\\\":\\\"\\\",\\\"merchantAppVersion\\\":\\\"\\\",\\\"sdkVersion\\\":\\\"\\\",\\\"appVersion\\\":\\\"\\\",\\\"clientKey\\\":\\\"\\\",\\\"extendInfo\\\":\\\"{\\\\\\\"deviceId\\\\\\\":\\\\\\\"Other\\\\\\\"}\\\",\\\"longitude\\\":\\\"\\\",\\\"latitude\\\":\\\"\\\",\\\"browserVersion\\\":\\\"\\\",\\\"browserType\\\":\\\"\\\",\\\"deviceModel\\\":\\\"\\\",\\\"deviceManufacturer\\\":\\\"\\\",\\\"deviceIMEI\\\":\\\"\\\",\\\"hybridPlatform\\\":\\\"\\\",\\\"hybridPlatformVersion\\\":\\\"\\\",\\\"timezone\\\":\\\"\\\",\\\"routerMac\\\":\\\"\\\",\\\"userAgent\\\":\\\"\\\",\\\"osVersion\\\":\\\"\\\",\\\"deviceId\\\":\\\"\\\",\\\"language\\\":\\\"\\\",\\\"genderType\\\":\\\"\\\",\\\"merchantType\\\":\\\"\\\",\\\"platform\\\":\\\"\\\",\\\"orderTerminalId\\\":\\\"26628476\\\",\\\"iccidnumber\\\":\\\"\\\"}\",\"THROUGH_BALANCE\":\"false\",\"txnType\":\"DEFAULT\",\"EXT_PASSTHROUGH\":\"{\\\"totalTxnAmount\\\":\\\"100063\\\",\\\"productBlocked\\\":\\\"false\\\",\\\"clientConfirmWaitTime\\\":\\\"0\\\",\\\"standardBrandEmi\\\":\\\"false\\\",\\\"bankManagedInstantDiscount\\\":\\\"false\\\",\\\"prepaidCard\\\":\\\"false\\\",\\\"linkBasedInvoicePayment\\\":\\\"false\\\",\\\"topupAndPay\\\":\\\"false\\\",\\\"isEdcReversalBasedFundbackEnabled\\\":\\\"false\\\",\\\"subventionCreated\\\":\\\"false\\\",\\\"edcRequest\\\":\\\"true\\\",\\\"notifyInfo\\\":\\\"{\\\\\\\"source\\\\\\\":\\\\\\\"EDC\\\\\\\",\\\\\\\"uniqueId\\\\\\\":\\\\\\\"QUERY_CAPTURE_9814662cc9084752bde0c442c3782a7314162apsouth1computeinternal\\\\\\\",\\\\\\\"destination\\\\\\\":\\\\\\\"ip-10-191-4-162.ap-south-1.compute.internal:eos\\\\\\\"}\\\",\\\"SUPPORT_PARTIAL_CAPTURE\\\":\\\"false\\\",\\\"paytmTid\\\":\\\"26628476\\\",\\\"requestType\\\":\\\"CAPTURE\\\",\\\"merchantLimitEnabled\\\":\\\"false\\\",\\\"brandValidationEnabled\\\":\\\"false\\\",\\\"isStandardBrandEmi\\\":\\\"false\\\",\\\"isBankManagedInstantDiscount\\\":\\\"false\\\",\\\"bankOfferApplied\\\":\\\"false\\\",\\\"merchantLimitUpdated\\\":\\\"false\\\",\\\"isProductBlocked\\\":\\\"false\\\",\\\"isEdcRequest\\\":\\\"true\\\",\\\"corporateCard\\\":\\\"false\\\",\\\"productCode\\\":\\\"51051000100000000147\\\",\\\"brandEmiPayInFullWithCashback\\\":\\\"false\\\",\\\"isSubventionCreated\\\":\\\"false\\\",\\\"looperExtendInfo\\\":\\\"{\\\\\\\"callbackUrl\\\\\\\":\\\\\\\"rmi://ip-10-191-4-162:13385/looperCallback\\\\\\\" ,\\\\\\\"localCacheKey\\\\\\\":\\\\\\\"QUERY_CAPTURE_9814662cc9084752bde0c442c3782a7314162apsouth1computeinternal\\\\\\\" }\\\",\\\"isIndian\\\":\\\"false\\\",\\\"merchantTransId\\\":\\\"2025082700400302079526628476\\\",\\\"paytmMerchantId\\\":\\\"HPCL3078443994364653\\\",\\\"isBankOfferApplied\\\":\\\"false\\\",\\\"isBrandEmiPayInFullWithCashback\\\":\\\"false\\\",\\\"loyaltyTxn\\\":\\\"false\\\",\\\"oldPGMerchantId\\\":\\\"216820000266977048752\\\",\\\"indian\\\":\\\"false\\\"}\",\"TIMEOUT_CONFIG_RULE_LIST\":\"[{\\\"timeoutType\\\":\\\"EXPIRY_TIMEOUT\\\",\\\"disabled\\\":\\\"false\\\",\\\"timeoutInSeconds\\\":\\\"117\\\",\\\"absoluteTimeout\\\":\\\"2025-09-01T00:42:00.952+05:30\\\"},{\\\"timeoutType\\\":\\\"INACTIVE_TIMEOUT\\\",\\\"disabled\\\":\\\"true\\\",\\\"timeoutInSeconds\\\":\\\"117\\\",\\\"absoluteTimeout\\\":\\\"2025-09-01T00:42:00.952+05:30\\\"},{\\\"timeoutType\\\":\\\"CONFIRM_TIMEOUT\\\",\\\"disabled\\\":\\\"false\\\",\\\"timeoutInSeconds\\\":\\\"43200\\\",\\\"absoluteTimeout\\\":\\\"2025-09-01T12:40:03.952+05:30\\\"}]\"},\"additionalMetaInfo\":{\"isPayAttempted\":\"T\",\"merchantOfficialName\":\"AUTO LINES\",\"pplusMid\":\"216820000266977048752\",\"virtualPaymentAddress\":\"8408969960-2@yescred\",\"pplusUserId\":\"216810000000000024242\",\"settleStrategy\":\"REALTIME\",\"productMode\":\"AUTH_CAPTURE\",\"instantSettlement\":\"false\",\"merchantLocalName\":\"AUTO LINES\",\"confirmTimeoutAction\":\"CONFIRM\",\"mpa\":\"501033007435648224\"},\"externalBuyerId\":\"\",\"externalBuyerType\":\"MERCHANT\",\"buyerNickname\":\"\",\"notificationUrl\":\"\",\"productCode\":\"51051000100000000147\",\"productMode\":\"AUTH_CAPTURE\",\"merchantTransType\":\"\",\"txnType\":\"DEFAULT\",\"tntInstId\":\"PAYTW3IN\",\"frozen\":false,\"confirmId\":\"20250827040841672614446067671047566\",\"requestId\":\"6cb7b960411b461fa1a5533df8bc658314162apsouth1computeinternal\",\"source\":\"MERCHANT\",\"amount\":{\"cent\":100063,\"currency\":\"INR\",\"currencyValue\":\"356\",\"currencyCode\":\"INR\",\"centFactor\":100,\"amount\":1000.63},\"lastConfirm\":true,\"acceptedTime\":\"2025-09-01T00:40:15.049+05:30\",\"assetfluxId\":\"202508273011000014000007610000021066642427908\",\"confirmedTime\":\"2025-09-01T00:40:15.177+05:30\",\"detailInfo\":[{\"id\":\"20250827040841672614446067671047566\",\"assetFluxId\":\"202508273011000014000007610000021066642427908\",\"assetFluxTime\":\"2025-09-01T00:40:15.137+05:30\",\"refId\":\"20250827010911672614332771942417566\",\"refAssetFluxId\":\"202508273011000013000007610000021065851289600\",\"refType\":\"ACQ_PAY\",\"amount\":{\"cent\":100063,\"currency\":\"INR\",\"currencyValue\":\"356\",\"currencyCode\":\"INR\",\"centFactor\":100,\"amount\":1000.63},\"channelInfo\":[{\"rrnCode\":null,\"virtualPaymentAddress\":null,\"userMobileNo\":null,\"accountNo\":\"\",\"action\":\"\",\"amount\":{\"cent\":100063,\"currency\":\"INR\",\"currencyValue\":\"356\",\"currencyCode\":\"INR\",\"centFactor\":100,\"amount\":1000.63},\"assetFluxFundDetailId\":\"\",\"assetTool\":\"EXTINSTPAY\",\"externalExtendInfo\":\"\",\"extSerialNo\":\"\",\"gateway\":\"UPIXW3IN\",\"issuerBank\":\"\",\"issuerBankInstCode\":\"\",\"payMethod\":\"UPI\",\"serviceInstId\":\"\",\"sourceAssetTool\":\"EXTINSTPAY\",\"status\":\"\",\"cardCacheToken\":\"\",\"feeItemCode\":null,\"cardIndexNo\":null,\"maskedCardNo\":\"\",\"maskedBankAccountNumber\":\"\",\"ifscCode\":\"\",\"cardScheme\":\"\",\"instUnionType\":\"\",\"instName\":\"\",\"addAndPay\":false,\"payRequestMaskedCardNo\":\"\",\"serviceInstOuterCode\":\"\",\"refundTurnAroundTime\":null,\"issuingBankName\":null,\"feeRateFactors\":{\"solutionWiseMdr\":\"QR\",\"upiModeSubType\":\"UPI_CREDIT_CARD\",\"instId\":\"UPIXW3IN\",\"isAuth\":\"TRUE\",\"serviceInstId\":\"PPBLC1IN\",\"cardType\":\"Platinum1\",\"upiCc\":\"TRUE\"},\"chargeAmountForBuyer\":null,\"payOption\":\"\"}]}],\"channelInfoDTO\":[{\"rrnCode\":null,\"virtualPaymentAddress\":null,\"userMobileNo\":null,\"accountNo\":\"\",\"action\":\"\",\"amount\":{\"cent\":100063,\"currency\":\"INR\",\"currencyValue\":\"356\",\"currencyCode\":\"INR\",\"centFactor\":100,\"amount\":1000.63},\"assetFluxFundDetailId\":\"\",\"assetTool\":\"EXTINSTPAY\",\"externalExtendInfo\":\"\",\"extSerialNo\":\"\",\"gateway\":\"UPIXW3IN\",\"issuerBank\":\"\",\"issuerBankInstCode\":\"\",\"payMethod\":\"UPI\",\"serviceInstId\":\"\",\"sourceAssetTool\":\"EXTINSTPAY\",\"status\":\"\",\"cardCacheToken\":\"\",\"feeItemCode\":null,\"cardIndexNo\":null,\"maskedCardNo\":\"\",\"maskedBankAccountNumber\":\"\",\"ifscCode\":\"\",\"cardScheme\":\"\",\"instUnionType\":\"\",\"instName\":\"\",\"addAndPay\":false,\"payRequestMaskedCardNo\":\"\",\"serviceInstOuterCode\":\"\",\"refundTurnAroundTime\":null,\"issuingBankName\":null,\"feeRateFactors\":{\"solutionWiseMdr\":\"QR\",\"upiModeSubType\":\"UPI_CREDIT_CARD\",\"instId\":\"UPIXW3IN\",\"isAuth\":\"TRUE\",\"serviceInstId\":\"PPBLC1IN\",\"cardType\":\"Platinum1\",\"upiCc\":\"TRUE\"},\"chargeAmountForBuyer\":null,\"payOption\":\"\"}],\"timeoutNeeded\":false,\"voidNeeded\":false,\"payId\":\"20250827010911672614332771942417566\",\"payAssetfluxId\":\"202508273011000013000007610000021065851289600\",\"paidTime\":\"2025-09-01T00:40:13.551+05:30\",\"chargeConsultNo\":\"\",\"merchantSolutionType\":\"OFFLINE\",\"contractVersionId\":\"176\",\"multiCapture\":false,\"isTxMessage\":true}";
        String encodeCompressedMsgis = compressMessageValue(curr);
        System.out.println("Encoded msg is: "+encodeCompressedMsgis);
        String encoded = "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";
        System.out.println("Decoded msg is:  "+ decompressMessageValue(encoded));

    }

    private static String compressMessageValue(String value) {
        if (StringUtils.isBlank(value)) {
            return value;
        }
        try {
            byte[] compressed = compress(value);
            return Base64.getEncoder().encodeToString(compressed);
        } catch (Exception e) {
            throw new RuntimeException("Failed to compress message value", e);
        }
    }

    public static byte[] compress(String inputString) throws IOException {
        if (StringUtils.isBlank(inputString)) {
            return null;
        }
        byte[] buffer = new byte[5000];
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

        Deflater deflater = new Deflater();
        deflater.setInput(inputString.getBytes(StandardCharsets.UTF_8));
        deflater.finish();

        while (!deflater.finished()) {
            int compressed_length = deflater.deflate(buffer);
            outputStream.write(buffer, 0, compressed_length);
        }
        deflater.end();
        outputStream.close();

        return outputStream.toByteArray();
    }

    public static String decompressMessageValue(String compressedValue) {
        if (StringUtils.isBlank(compressedValue)) {
            return compressedValue;
        }
        try {
            byte[] decoded = Base64.getDecoder().decode(compressedValue);
            return decompress(decoded);
        } catch (Exception e) {
            throw new RuntimeException("Failed to decompress message value", e);
        }
    }

    public static String decompress(byte[] bytes) throws DataFormatException, IOException {

        byte[] buffer = new byte[5000];
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

        Inflater inflater = new Inflater();
        inflater.setInput(bytes);

        while (!inflater.finished()) {
            int decompressed_length = inflater.inflate(buffer);
            outputStream.write(buffer, 0, decompressed_length);
        }
        inflater.end();
        outputStream.close();

        return outputStream.toString();

    }
}
